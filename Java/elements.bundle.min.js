var Airwallex=function(e){"use strict";var t={version:"v1.1070.0"};const n={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",dev:"checkout-dev.airwallex.com",local:"localhost:3000"},i=e=>`https://${n[e]||"checkout.airwallex.com"}`,o=e=>{const t=e.replace("https://","");return Object.keys(n).find(e=>{if(n[e]===t)return e})},s=()=>{var e;"function"==typeof(null===(e=window.performance)||void 0===e?void 0:e.mark)&&window.performance.mark("awx-start-mount-element")},a="AIR_ANALYTICS_DEVICE_ID",l="AIR_ANALYTICS_SESSION_ID",d=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});let r={appName:"pa_checkout_web_SDK",appVersion:null==t?void 0:t.version,deviceId:(()=>{try{let e=window.localStorage.getItem(a);return e||(e=d(),window.localStorage.setItem(a,e)),e}catch(e){return"deviceId"}})(),sessionId:(()=>{try{let e=window.sessionStorage.getItem(l);return e||(e=d(),window.sessionStorage.setItem(l,e)),e}catch(e){return d()}})(),useApplePaySDK:!1,displayApplePayButtonQrCode:!1,displayApplePayButtonOriginal:!0,fromAxios:!1};const v="onReady",c="onSuccess",u="onError",p="onCancel",m="onClickConfirmButton",h="onSubmit",y="confirm",w="addListener",g="createPaymentConsent",f="verifyConsent",b="createPaymentMethod",C="getPaymentIntent",E="getBinInfo",I="destroy",P="onAuthorized",A="onShippingAddressChange",S="onShippingMethodChange",L="onApplePayButtonClick",x="onConfirmIntent",N="onRetrieveIntent",U="onCreatePaymentMethod",k="onVerifyConsent",$="applePaySDKLoadError",M="fraudEvents",R="bundleHandle3ds",j="destroyChildNodes",_="3DS_WRAPPER_LOADED",T=e=>{r={...r,...e}},W=()=>r.displayApplePayButtonQrCode?"qr_code":"button",D=()=>{var e;return(null===(e=window._AirwallexSDKs)||void 0===e?void 0:e.airTracker)?"components-sdk":"airwallex-payment-elements"},F=({elementType:e,elementMountStatus:t,env:n})=>{var i,o,s,a,l,d,r,v,c,u,p,m,h;if("function"==typeof(null===(i=window.performance)||void 0===i?void 0:i.mark)&&"function"==typeof(null===(o=window.performance)||void 0===o?void 0:o.measure)){window.performance.mark("awx-end-mount-element"),window.performance.measure("awx-mount-element-performance","awx-start-mount-element","awx-end-mount-element");const i=null!==(l=null===(a=null===(s=window.performance.getEntriesByName("awx-mount-element-performance"))||void 0===s?void 0:s[0])||void 0===a?void 0:a.duration)&&void 0!==l?l:"unknown",o=null!==(v=null===(r=null===(d=window.performance.getEntriesByName("awx-start-mount-element"))||void 0===d?void 0:d[0])||void 0===r?void 0:r.startTime)&&void 0!==v?v:"unknown",y=null!==(p=null===(u=null===(c=window.performance.getEntriesByName("awx-end-mount-element"))||void 0===c?void 0:c[0])||void 0===u?void 0:u.startTime)&&void 0!==p?p:"unknown",w=window.performance.getEntriesByType("resource").find(e=>e.name.includes("/assets/elements.bundle.min.js"));B({env:n,eventName:"onReportAwxElementMountDuration",severity:"verbose",elementMountStatus:t,duration:i,origin:window.location.origin,record:{end:y,start:o,localtime:(new Date).valueOf(),name:"awx_sdk_performance",time:i,key:`mountElement-${e}-id`,bundleJsDuration:null!==(h=Math.floor(null!==(m=null==w?void 0:w.duration)&&void 0!==m?m:0))&&void 0!==h?h:"unknown"}},{elementType:e})}},B=(e,t)=>{const n=e.env||"staging",i=e.severity||"info";try{const o=`https://o11y${"prod"===n?"":`-${n}`}.airwallex.com/airtracker/logs`,s={commonData:{...r,env:n,sourceSDK:D(),...t,merchantOrigin:window.location.origin,from:"bundle"},data:[{severity:i,eventTime:(new Date).toISOString(),...e}]};if("function"==typeof window.navigator.sendBeacon){const e=new Blob([JSON.stringify(s)],{type:"text/plain; charset=UTF-8"});window.navigator.sendBeacon(o,e)}else"function"==typeof window.fetch?(s.commonData.fromAxios=!0,Promise.race([fetch(o,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"},credentials:"omit"}),new Promise(e=>{window.setTimeout(e,1e3)})])):console.warn("No beacon or fetch function found")}catch(e){console.error(e)}},O=e=>`on${e.charAt(0).toUpperCase()+e.slice(1)}`,H=e=>{var t;return(null===(t=null==e?void 0:e.intent)||void 0===t?void 0:t.id)||(null==e?void 0:e.intent_id)},z=(e,t)=>{if("applePayButton"===e||"googlePayButton"===e)return!(null==t?void 0:t.client_secret)};class q{constructor(e,t){var n,i,o,s;this.listeners={};const[a,l]=(({options:e={},keys:t=[]})=>{const n={},i={};return Object.entries(e).forEach(([e,o])=>{t.includes(e)?n[e]=o:i[e]=o}),[n,i]})({options:t,keys:["appearance","layout"]});this.domElement=null,this.gatewayUrl=e,this.env=null!==(i=null===(n=this.gatewayUrl.match(/^https:\/\/checkout-?(staging|demo)\.airwallex\.com/))||void 0===n?void 0:n[1])&&void 0!==i?i:"prod",this.options=l,this.iframe=window.document.createElement("iframe"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","true"),this.iframe.setAttribute("importance","high"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("allowpaymentrequest","true"),this.iframe.setAttribute("allow","payment"),null===(o=this.iframe)||void 0===o||o.setAttribute("style","\n        transition: height 0.35s ease 0s;\n        height: 0;\n        width: 100%;\n        display: block;\n      "),null===(s=this.iframe)||void 0===s||s.addEventListener("error",()=>{this.elementMountStatus||(this.elementMountStatus="ERROR",F({elementType:this.elementType,elementMountStatus:"ERROR",env:this.env}))}),this.windowMessageListener=e=>{var t,n,i,o;if(e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)){(null===(n=e.data)||void 0===n?void 0:n.type)!==this.elementType||this.elementMountStatus||(this.elementMountStatus="SUCCESS",F({elementType:this.elementType,elementMountStatus:"SUCCESS",env:this.env})),a&&Object.keys(a).length>0&&Object.values(a).some(e=>e&&"object"==typeof e&&Object.keys(e).length>0)&&this.update(a);const t=new CustomEvent(null===(i=e.data)||void 0===i?void 0:i.code,{detail:{type:null===(o=e.data)||void 0===o?void 0:o.type},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}},this.cleanupMessageListener=(e=>{const t=t=>{window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(t.data)),e(t)};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}})(this.windowMessageListener)}addResizeListener(e){this.resizeListener=t=>{var n,i,o,s;if(t.origin===this.gatewayUrl&&t.isTrusted&&"onResize"===(null===(n=t.data)||void 0===n?void 0:n.code)&&e===(null===(i=t.data)||void 0===i?void 0:i.type)){const e=null===(o=this.iframe)||void 0===o?void 0:o.style;e&&(e.height=`${null===(s=t.data)||void 0===s?void 0:s.height}px`)}},window.addEventListener("message",this.resizeListener)}mount(e){if("string"!=typeof e)return(null==e?void 0:e.hasChildNodes())&&(e.innerHTML="",B({eventName:j,env:this.env},{elementType:this.elementType})),this.iframe&&(e.appendChild(this.iframe),s()),this.domElement=e,e;{const t=window.document.getElementById(e);return(null==t?void 0:t.hasChildNodes())&&(t.innerHTML="",B({eventName:j,env:this.env},{elementType:this.elementType})),this.iframe&&(null==t||t.appendChild(this.iframe),s()),t&&(this.domElement=t),t}}blur(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"blur"},this.gatewayUrl)}clear(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"clear"},this.gatewayUrl)}destroy(){var e;this.clear(),null===(e=this.iframe)||void 0===e||e.remove(),this.iframe=null,this.resizeListener&&(window.removeEventListener("message",this.resizeListener),this.resizeListener=void 0),this.cleanupMessageListener&&(this.cleanupMessageListener(),this.cleanupMessageListener=void 0),Object.keys(this.listeners||{}).forEach(e=>{var t;null===(t=this.domElement)||void 0===t||t.removeEventListener(O(e),this.listeners[e])})}focus(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"focus"},this.gatewayUrl)}pressArrowKey(e,t){var n;const i=new CustomEvent("onPressArrowKey",{detail:{type:e,arrowKey:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(i)}unmount(){var e;this.clear(),this.iframe&&(null===(e=this.domElement)||void 0===e||e.removeChild(this.iframe))}update(e,t){var n,i;this.options={...this.options,...e},null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"update",options:e,initOptions:t},this.gatewayUrl)}async confirm(){throw new Error("Confirm is not supported in ElementBase")}success(e,t){throw new Error(`Call success with ${e.id||(null==t?void 0:t.id)} is not supported in ElementBase`)}fail(e){throw new Error(`Call fail with ${e.code}: ${e.message} is not supported in ElementBase`)}recordLog({eventName:e,severity:t="info",...n}){var i;const{intentId:o}=n,s=z(this.elementType,this.options),a={elementType:this.elementType,intentId:H(this.options)||o,isExpressCheckout:s,mode:""};"dropIn"!==this.elementType&&"applePayButton"!==this.elementType&&"googlePayButton"!==this.elementType||(a.mode=(null===(i=this.options)||void 0===i?void 0:i.mode)||"payment"),B({env:this.env,eventName:e,severity:t,...n},a)}}const J="applePayButton",V=e=>{const t=[];return e&&(null==e?void 0:e.length)>0&&e.forEach(e=>{t.push(new ApplePayError(e.code,e.contactField,e.message))}),t};class K extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.session=void 0,this.paymentData=void 0,this.elementType=J,this.confirmIntentPromise={resolver:null,reject:null,awaiting:!1},this.paymentConsentPromise={resolver:null,reject:null,awaiting:!1},this.paymentConsentPromise={resolver:null,reject:null,awaiting:!1},this.shippingAddressChangePromise={resolver:null,reject:null,awaiting:!1},this.shippingMethodChangePromise={resolver:null,reject:null,awaiting:!1},null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/apple-pay?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex apple pay button iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex apple pay button iframe"),this.addResizeListener(J),this.listenerFunc=e=>{var t,n,o,s,a,l,d,r,v,c,u,p;try{if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===J)switch(null===(n=e.data)||void 0===n?void 0:n.code){case"onReady":St&&(null===(s=null===(o=this.iframe)||void 0===o?void 0:o.contentWindow)||void 0===s||s.postMessage({code:"onApplePaySDKBlocked"},this.gatewayUrl)),this.ready();break;case"onApplePayButtonClick":if(!("ApplePaySession"in window)){B({env:null===(a=bt.options)||void 0===a?void 0:a.env,eventName:$},{elementType:"applePayButton"});break}this.session||(this.request=e.data.res,this.session=new ApplePaySession(4,e.data.res)),T({useApplePaySDK:e.data.useApplePaySDK,displayApplePayButtonQrCode:e.data.displayApplePayButtonQrCode,displayApplePayButtonOriginal:e.data.displayApplePayButtonOriginal}),this.click(),this.session.onvalidatemerchant=async e=>{var t,n;const o=e.validationURL;i.client_secret?null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onvalidatemerchant",validationURL:o},this.gatewayUrl):this.validateMerchant(o)},this.session.onpaymentauthorized=async e=>{var t,n;this.paymentData=e.payment,i.client_secret?null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onpaymentauthorized",token:e.payment.token,billingContact:e.payment.billingContact,shippingContact:e.payment.shippingContact},this.gatewayUrl):this.authorized(e.payment)},this.session.oncancel=e=>{this.session=void 0,this.cancel(e)},this.listeners.shippingMethodChange&&(this.session.onshippingmethodselected=async e=>{var t;const n=await this.shippingMethodChange(e);n&&(null===(t=this.session)||void 0===t||t.completeShippingMethodSelection(n))}),this.listeners.shippingAddressChange&&(this.session.onshippingcontactselected=async e=>{var t;const n=await this.shippingAddressChange(e);n&&(null===(t=this.session)||void 0===t||t.completeShippingContactSelection(n))}),this.session.begin();break;case"onApplePayValidateSuccess":null===(l=this.session)||void 0===l||l.completeMerchantValidation(e.data.res);break;case"onSuccess":{const t={status:ApplePaySession.STATUS_SUCCESS};null===(d=this.session)||void 0===d||d.completePayment(t),this.session=void 0,this.success(null===(r=e.data)||void 0===r?void 0:r.intent,null===(v=e.data)||void 0===v?void 0:v.consent);break}case"onError":{const t={status:ApplePaySession.STATUS_FAILURE};this.paymentData?null===(u=this.session)||void 0===u||u.completePayment(t):null===(c=this.session)||void 0===c||c.abort(),this.session=void 0,this.fail(null===(p=e.data)||void 0===p?void 0:p.error);break}}}catch(e){this.session=void 0,console.error(e)}},window.addEventListener("popstate",()=>{window.removeEventListener("message",this.listenerFunc)}),window.addEventListener("message",this.listenerFunc)}ready(){var e;const t=new CustomEvent("onReady",{detail:{type:J},bubbles:!0,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t),this.recordLog({eventName:v})}click(){var e;const t=new CustomEvent("onClick",{detail:{type:J,apple_pay_mode:W()},bubbles:!0,composed:!0});this.recordLog({eventName:L}),null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)}cancel(e){var t;const n=new CustomEvent("onCancel",{detail:{type:J,apple_pay_mode:W(),event:e},bubbles:!0,composed:!0});this.recordLog({eventName:p}),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}success(e,t){var n;let i="";if(this.confirmIntentPromise.awaiting&&this.confirmIntentPromise.resolver)i=x,this.confirmIntentPromise.resolver(e);else if(this.paymentConsentPromise.awaiting&&this.paymentConsentPromise.resolver)i=k,this.paymentConsentPromise.resolver(t);else{const i=new CustomEvent("onSuccess",{detail:{type:J,apple_pay_mode:W(),intent:e,consent:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(i)}this.recordLog({eventName:c,intent:e,intentId:null==e?void 0:e.id,type:i,consent:t,apple_pay_mode:W()})}fail(e){var t;let n="";if(this.confirmIntentPromise.awaiting&&this.confirmIntentPromise.reject)n=x,this.confirmIntentPromise.reject(e);else if(this.paymentConsentPromise.awaiting&&this.paymentConsentPromise.reject)n=k,this.paymentConsentPromise.reject(e);else{const n=new CustomEvent("onError",{detail:{type:J,error:e,apple_pay_mode:W()},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}this.confirmIntentPromise={resolver:null,reject:null,awaiting:!1},this.paymentConsentPromise={resolver:null,reject:null,awaiting:!1},this.recordLog({eventName:u,severity:"warn",error:e,type:n,apple_pay_mode:W()})}destroy(){super.destroy(),this.recordLog({eventName:I}),window.removeEventListener("message",this.listenerFunc)}async confirmIntent(e){var t,n,i,o,s;this.confirmIntentPromise.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const a=new Promise((e,t)=>{this.confirmIntentPromise.resolver=e,this.confirmIntentPromise.reject=t,this.confirmIntentPromise.awaiting=!0});return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onpaymentauthorized",token:null===(i=this.paymentData)||void 0===i?void 0:i.token,billingContact:null===(o=this.paymentData)||void 0===o?void 0:o.billingContact,shippingContact:null===(s=this.paymentData)||void 0===s?void 0:s.shippingContact,...e},this.gatewayUrl),this.recordLog({eventName:y}),a}completeValidation(e){var t;this.recordLog({eventName:"completeValidation",data:e}),null===(t=this.session)||void 0===t||t.completeMerchantValidation(e)}async createPaymentConsent(e){var t,n,i,o,s;return this.paymentConsentPromise.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!"),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onpaymentauthorized",token:null===(i=this.paymentData)||void 0===i?void 0:i.token,billingContact:null===(o=this.paymentData)||void 0===o?void 0:o.billingContact,shippingContact:null===(s=this.paymentData)||void 0===s?void 0:s.shippingContact,...e,mode:"recurring"},this.gatewayUrl),this.recordLog({eventName:g}),new Promise((e,t)=>{this.paymentConsentPromise.resolver=e,this.paymentConsentPromise.reject=t,this.paymentConsentPromise.awaiting=!0})}update(e){var t,n,i,o,s,a,l,d,r,v,c;if(super.update(e),this.recordLog({eventName:"update",options:e,intentId:null==e?void 0:e.intent_id}),this.shippingAddressChangePromise.awaiting&&this.shippingAddressChangePromise.resolver){const a=V((null==e?void 0:e.errors)||[]);this.shippingAddressChangePromise.resolver({newLineItems:null==e?void 0:e.lineItems,newShippingMethods:null==e?void 0:e.shippingMethods,newTotal:{label:(null==e?void 0:e.totalPriceLabel)||(null===(n=null===(t=this.request)||void 0===t?void 0:t.total)||void 0===n?void 0:n.label)||"",amount:((null===(i=null==e?void 0:e.amount)||void 0===i?void 0:i.value)||(null===(o=this.request)||void 0===o?void 0:o.total.amount)||0).toString(),type:(null==e?void 0:e.totalPriceType)||(null===(s=this.request)||void 0===s?void 0:s.total.type)||"final"},errors:a}),this.shippingAddressChangePromise={resolver:null,reject:null,awaiting:!1}}else if(this.shippingMethodChangePromise.awaiting&&this.shippingMethodChangePromise.resolver)this.shippingMethodChangePromise.resolver({newTotal:{label:(null==e?void 0:e.totalPriceLabel)||(null===(l=null===(a=this.request)||void 0===a?void 0:a.total)||void 0===l?void 0:l.label)||"",amount:((null===(d=null==e?void 0:e.amount)||void 0===d?void 0:d.value)||(null===(r=this.request)||void 0===r?void 0:r.total.amount)||0).toString(),type:(null==e?void 0:e.totalPriceType)||(null===(v=this.request)||void 0===v?void 0:v.total.type)||"final"},newLineItems:null==e?void 0:e.lineItems}),this.shippingMethodChangePromise={resolver:null,reject:null,awaiting:!1};else if(null==e?void 0:e.errors){const t=V((null==e?void 0:e.errors)||[]),n={status:ApplePaySession.STATUS_FAILURE,errors:t};null===(c=this.session)||void 0===c||c.completePayment(n)}}shippingAddressChange(e){var t;const n=new Promise((e,t)=>{this.shippingAddressChangePromise.resolver=e,this.shippingAddressChangePromise.reject=t,this.shippingAddressChangePromise.awaiting=!0}),i=new CustomEvent("onShippingAddressChange",{detail:{type:J,shippingAddress:e.shippingContact,apple_pay_mode:W()},bubbles:!0,composed:!0});return this.recordLog({eventName:A,apple_pay_mode:W()}),null===(t=this.domElement)||void 0===t||t.dispatchEvent(i),n}validateMerchant(e){var t;const n=new CustomEvent("onValidateMerchant",{detail:{type:J,validationURL:e,apple_pay_mode:W()},bubbles:!0,composed:!0});this.recordLog({eventName:"validateMerchant",validationURL:e,apple_pay_mode:W()}),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}shippingMethodChange(e){var t;const n=new Promise((e,t)=>{this.shippingMethodChangePromise.resolver=e,this.shippingMethodChangePromise.reject=t,this.shippingMethodChangePromise.awaiting=!0}),i=new CustomEvent("onShippingMethodChange",{detail:{type:J,shippingMethod:e.shippingMethod,apple_pay_mode:W()},bubbles:!0,composed:!0});return null===(t=this.domElement)||void 0===t||t.dispatchEvent(i),this.recordLog({eventName:S,event:e,apple_pay_mode:W()}),n}authorized(e){var t;const n=new CustomEvent("onAuthorized",{detail:{type:J,paymentData:e,apple_pay_mode:W()},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:P,event:e,apple_pay_mode:W()})}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}class Q extends q{constructor(e,t,n){var i,o,s,a;super(e,n),this.confirmResponse=t,null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/elements/3ds-frictionless?options=${encodeURIComponent(JSON.stringify(this.options))}&lang=${null===(o=bt.options)||void 0===o?void 0:o.locale}`),null===(s=this.iframe)||void 0===s||s.setAttribute("name","Airwallex 3DS frictionless iframe"),null===(a=this.iframe)||void 0===a||a.setAttribute("title","Airwallex 3DS frictionless iframe"),window.addEventListener("message",e=>{var t,n,i,o;e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsFrictionless"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:this.confirmResponse},this.gatewayUrl))})}async confirm(){var e,t;return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),null}}class Z extends q{constructor(e,t,n){var i,o,s,a,l,d;super(e,n),this.confirmResponse=t,null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/elements/3ds-challenge?options=${encodeURIComponent(JSON.stringify(this.options))}`),null===(o=this.iframe)||void 0===o||o.setAttribute("name","Airwallex 3DS challenge iframe"),null===(s=this.iframe)||void 0===s||s.setAttribute("title","Airwallex 3DS challenge iframe"),null===(a=this.iframe)||void 0===a||a.setAttribute("scrolling","yes"),pe({challengeWindowSize:null==n?void 0:n.customizeChallengeWindowSize,style:{popupWidth:null===(l=null==n?void 0:n.style)||void 0===l?void 0:l.popupWidth,popupHeight:null===(d=null==n?void 0:n.style)||void 0===d?void 0:d.popupHeight},useDefaultStyle:null==n?void 0:n.useDefaultStyle,iframe:this.iframe}),window.addEventListener("message",e=>{var t,n,i,o;e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsChallenge"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:this.confirmResponse},this.gatewayUrl))})}async confirm(){var e,t;return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),null}}let G="";const Y=({orderSessionId:e,env:t,merchantId:n})=>{var i;let o;switch(t){case"prod":o="";break;case"preview":o="-staging";break;case"qa":o="-dev";break;default:o=`-${t}`}const s="airwallex-fraud-api",a=null!==document.getElementById(s);if(a)return;const l=`https://static${o}.airwallex.com/webapp/fraud/device-fingerprint/index.js?sessionId=${e}&hasScriptId=${a}&disable3rdTracking=false${n?"&merchantId="+n:""}`,d=document.createElement("script");B({severity:"verbose",env:t,eventName:M,methodName:"injectDeviceFingerprintJS",hasScriptId:a,jsUrl:l,orderSessionId:e}),d.setAttribute("id",s),d.setAttribute("data-order-session-id",e),d.setAttribute("data-tenant","pa"),d.setAttribute("data-project-name","element-js"),d.addEventListener("load",()=>{B({severity:"verbose",env:t,eventName:M,methodName:"injectDeviceFingerprintJS - load",hasScriptId:a,jsUrl:l,orderSessionId:e})}),d.addEventListener("error",()=>{B({severity:"verbose",env:t,eventName:M,methodName:"injectDeviceFingerprintJS - error",hasScriptId:a,jsUrl:l,orderSessionId:e})}),d.src=l,null===(i=null===document||void 0===document?void 0:document.head)||void 0===i||i.appendChild(d)},X={"01":["250px","400px"],"02":["390px","400px"],"03":["500px","600px"],"04":["600px","400px"],"05":["100%","100%"]},ee="\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 0%;\n  z-index: 1500;\n  overflow: hidden;\n  background: rgba(84, 84, 94, 0.3);\n",te="threeDsFrictionless",ne="threeDsChallenge";let ie,oe,se,ae,le,de,re,ve,ce=null;const ue={resolver:null,reject:null,awaiting:!1},pe=({challengeWindowSize:e,style:t,useDefaultStyle:n=!0,iframe:i})=>{const o=e&&X[e]?X[e]:X["05"],s=(null==t?void 0:t.popupWidth)?`${null==t?void 0:t.popupWidth}px`:o[0],a=(null==t?void 0:t.popupHeight)?`${null==t?void 0:t.popupHeight}px`:o[1];i.setAttribute("style",`\n    background: white;\n    width: ${s};\n    height: ${a};\n    position: ${n?"absolute":"relative"};\n    top: ${n?"50%":"0"};\n    left: ${n?"50%":"0"};\n    transform: ${n?"translate(-50%, -50%)":"none"};\n    border-radius: ${n?"4px":"0"};\n    `)},me=()=>{ce&&(ce.remove(),ce=null)},he=e=>{var t;null===(t=document.querySelector(`#${e}`))||void 0===t||t.remove(),Nt(e===te?te:ne)},ye=()=>{ue.awaiting=!1,ue.resolver=null,ue.reject=null},we=e=>{var t,n,i,o,s,a;const l="data"in e?e.data:e.detail,d=["hpp","api"].includes(se),r=d?null:Ut(se),v=(null==r?void 0:r.gatewayUrl)||window.location.origin;("data"in e&&e.origin===v&&e.isTrusted||d)&&(null==l?void 0:l.type)===ne&&("onReady"===(null==l?void 0:l.code)&&(B({env:null===(t=bt.options)||void 0===t?void 0:t.env,eventName:R,method:"challengeHandler onReady"}),setTimeout(()=>{me(),ie.style.height="100%"},2e3)),"onChallengeSuccess"===(null==l?void 0:l.code)&&(B({env:null===(n=bt.options)||void 0===n?void 0:n.env,eventName:R,method:"challengeHandler onChallengeSuccess"}),ie.style.height="0"),"onSuccess"===(null==l?void 0:l.code)&&(B({env:null===(i=bt.options)||void 0===i?void 0:i.env,eventName:R,method:"challengeHandler onSuccess"}),null===(o=ue.resolver)||void 0===o||o.call(ue,l),ye(),he(ne)),["onError","onChallengeError"].includes(null==l?void 0:l.code)&&(B({env:null===(s=bt.options)||void 0===s?void 0:s.env,eventName:R,method:"challengeHandler onError"}),null===(a=ue.reject)||void 0===a||a.call(ue,l.error),ye(),he(ne)))},ge=e=>{var t;he(te),oe?ie=oe:(ie=document.createElement("div"),ie.setAttribute("id",ne),ie.setAttribute("style",ee),document.body.appendChild(ie)),kt(ne,new Z(re,e,{origin:window.location.origin,style:{popupWidth:ae,popupHeight:le},useDefaultStyle:null===oe,customizeChallengeWindowSize:de,intent:ve})),window.addEventListener("message",we),null===(t=Ut(ne))||void 0===t||t.mount(ie)},fe=e=>{var t,n,i,o,s;const a="data"in e?e.data:e.detail,l=["hpp","api"].includes(se),d=l?null:Ut(se),r=(null==d?void 0:d.gatewayUrl)||window.location.origin;("data"in e&&e.origin===r&&e.isTrusted||l)&&(null==a?void 0:a.type)===te&&(he(ne),"onSuccess"===(null==a?void 0:a.code)&&(B({env:null===(t=bt.options)||void 0===t?void 0:t.env,eventName:R,method:"frictionlessHandler onSuccess"}),me(),null===(n=ue.resolver)||void 0===n||n.call(ue,a),ye(),he(te)),["onError","onChallengeError"].includes(null==a?void 0:a.code)&&(B({env:null===(i=bt.options)||void 0===i?void 0:i.env,eventName:R,method:"frictionlessHandler onSuccess"}),null===(o=ue.reject)||void 0===o||o.call(ue,a.error),ye(),he(te),me()),"onChallenge"===(null==a?void 0:a.code)&&(B({env:null===(s=bt.options)||void 0===s?void 0:s.env,eventName:R,method:"frictionlessHandler buildOnChallengeIframe"}),ge(a)))},be=({type:e,popupWidth:t,popupHeight:n,authFormContainer:i,lang:o})=>{ae=t,le=n;const s=async t=>{var n,a,l,d,r;const v="data"in t?t.data:t.detail,c="hpp"===e,u=c?null:Ut(e),p=(null==u?void 0:u.gatewayUrl)||window.location.origin;if(("data"in t&&t.origin===p&&t.isTrusted||c)&&(null==v?void 0:v.type)===e&&"onChallenge"===(null==v?void 0:v.code)){null===(n=t.stopImmediatePropagation)||void 0===n||n.call(t);const{next_action:c,intent:m}=v;try{const t=await(({intent:e,gatewayUrl:t,next_action:n,authFormContainer:i,componentType:o,challengeWindowSize:s,lang:a})=>{var l,d;return B({env:null===(l=bt.options)||void 0===l?void 0:l.env,eventName:R,method:"threeDsHandler onChallenge"}),oe=document.getElementById(i||""),se=o,de=s,re=t,ve=e,he(te),he(ne),(({gatewayUrl:e,challengeWindowSize:t,style:n,lang:i})=>{setTimeout(()=>{if(ce)return;const o=null===oe,s=document.createElement("iframe");s.setAttribute("src",`${e}/#/elements/loading?lang=${i}`),s.setAttribute("frameborder","0"),pe({challengeWindowSize:t,style:n,useDefaultStyle:o,iframe:s}),ce=document.createElement("div"),ce.setAttribute("id","threeDsLoading"),ce.setAttribute("style",ee),ce.style.height="100%",ce.appendChild(s),document.body.appendChild(ce)},4)})({gatewayUrl:t,challengeWindowSize:s,lang:a,style:{popupWidth:ae,popupHeight:le}}),"WAITING_USER_INFO_INPUT"===(null==n?void 0:n.stage)?(B({env:null===(d=bt.options)||void 0===d?void 0:d.env,eventName:R,method:"buildOnChallengeIframe threeDsFrictionless"}),ge({type:"threeDsFrictionless",next_action:n})):setTimeout(()=>{var e,t;if(window.document.getElementById(te))return;B({env:null===(e=bt.options)||void 0===e?void 0:e.env,eventName:R,method:"buildOnFrictionLessIframe"}),kt(te,new Q(re,{code:"",type:te,next_action:n},{intent:ve,origin:window.location.origin}));const i=document.createElement("div");i.setAttribute("id",te),document.body.appendChild(i),window.addEventListener("message",fe),null===(t=Ut(te))||void 0===t||t.mount(i)},4),new Promise((e,t)=>{ue.resolver=e,ue.reject=t,ue.awaiting=!0})})({gatewayUrl:p,intent:m,next_action:c,authFormContainer:i,componentType:e,lang:o});"hpp"===e?(e=>{const t=new CustomEvent("on3dsSuccess",{detail:e,bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(t):null===(l=null===(a=null==u?void 0:u.iframe)||void 0===a?void 0:a.contentWindow)||void 0===l||l.postMessage({code:"on3dsSuccess",confirmResult:t},p),window.removeEventListener("message",s),window.removeEventListener("message",fe),window.removeEventListener("message",we)}catch(t){"hpp"===e?(e=>{const t=new CustomEvent("on3dsError",{detail:{error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(t):null===(r=null===(d=null==u?void 0:u.iframe)||void 0===d?void 0:d.contentWindow)||void 0===r||r.postMessage({code:"on3dsError",error:t},p),window.removeEventListener("message",we)}}};window.addEventListener("message",s)},Ce="on3dsCancel",Ee="on3dsSuccess",Ie="on3dsError";let Pe,Ae,Se,Le=null;const xe=["100%","100%"],Ne=()=>{if(Le)if(Pe){for(;Le.firstChild;)Le.removeChild(Le.firstChild);Le.style.height="0%"}else Le.remove(),Le=null},Ue=({popupWidth:e,popupHeight:n,authFormContainer:i,lang:s,loadingColor:a})=>{var l;Ae=e,Se=n,Pe=document.getElementById(i||""),window._airwallexThreeDsListenerFlag||(window.addEventListener("message",async e=>{var n,i,l,d,r,v,c,u,p,m,h,y,w,g,f,b,C,E,I;const P="data"in e?e.data:e.detail;if(!(null==P?void 0:P.type))return;const A="hpp"===(null==P?void 0:P.type),S=A?null:Ut(null==P?void 0:P.type),L=(null==S?void 0:S.gatewayUrl)||window.location.origin;switch(null==P?void 0:P.code){case"onTrigger3ds":(({gatewayUrl:e,nextActionUrl:n,nextActionStage:i,style:s,lang:a,intentId:l,accountId:d,clientSecret:r,componentName:v})=>{setTimeout(()=>{var c;if((null==Le?void 0:Le.children)&&(null===(c=null==Le?void 0:Le.children)||void 0===c?void 0:c.length)>0)return;Pe?Le=Pe:Le||(Le=document.createElement("div"),Le.setAttribute("id","threeDs"),Le.setAttribute("style","\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 0;\n  z-index: 2147483647;\n  overflow: hidden;\n  background: rgba(84, 84, 94, 0.3);\n"),document.body.appendChild(Le));const u=null===Pe,p=document.createElement("iframe"),{authPopupWidth:m,authPopupHeight:h}=(({style:e,useDefaultStyle:t=!0,iframe:n})=>{const i=(null==e?void 0:e.popupWidth)?`${null==e?void 0:e.popupWidth}px`:xe[0],o=(null==e?void 0:e.popupHeight)?`${(null==e?void 0:e.popupHeight)+54}px`:xe[1],s=(null==e?void 0:e.popupHeight)?`${null==e?void 0:e.popupHeight}px`:xe[1];return null==n||n.setAttribute("style",`\n      background: white;\n      width: ${i};\n      height: ${o};\n      position: ${t?"absolute":"relative"};\n      top: ${t?"50%":"0"};\n      left: ${t?"50%":"0"};\n      transform: ${t?"translate(-50%, -50%)":"none"};\n      border-radius: ${t?"4px":"0"};\n      `),{authPopupWidth:i,authPopupHeight:s}})({style:s,useDefaultStyle:u,iframe:p});p.setAttribute("frameborder","0"),p.setAttribute("name","Airwallex 3DS wrapper iframe"),p.setAttribute("src",`${e}/#/elements/loading?url=${encodeURIComponent(n)}&width=${encodeURIComponent(m)}&height=${encodeURIComponent(h)}&clientSecret=${encodeURIComponent(r||"")}&origin=${encodeURIComponent(window.location.origin)}&componentName=${encodeURIComponent(v||"")}&nextActionStage=${i}&paymentIntentId=${l}&lang=${encodeURIComponent(a||"")}&appVersion=${encodeURIComponent(null==t?void 0:t.version)}&accountId=${encodeURIComponent(d||"")}&loadingColor=${(null==s?void 0:s.loadingColor)||"#612FFF"}`),Le.style.height="0%",Le.appendChild(p),p.onload=()=>{setTimeout(()=>{Le&&(Le.style.height="100%")},800),B({createdAt:new Date,env:o(e),eventName:_,paymentIntentId:l,nextActionStage:i},{appName:"pa-card-3ds",accountId:d})}},50)})({gatewayUrl:L,nextActionUrl:null===(n=null==P?void 0:P.next_action)||void 0===n?void 0:n.url,nextActionStage:null===(i=null==P?void 0:P.next_action)||void 0===i?void 0:i.stage,intentId:null===(l=null==P?void 0:P.intent)||void 0===l?void 0:l.id,clientSecret:null===(d=null==P?void 0:P.intent)||void 0===d?void 0:d.client_secret,accountId:null==P?void 0:P.accountId,componentName:null==P?void 0:P.type,lang:s,style:{popupWidth:Ae,popupHeight:Se,loadingColor:a}}),B({env:null===(r=bt.options)||void 0===r?void 0:r.env,eventName:"onTrigger3ds",...P},{intentId:null===(v=null==P?void 0:P.intent)||void 0===v?void 0:v.id});break;case"on3dsLoadingUIReady":Le&&"100%"!==Le.style.height&&(Le.style.height="100%",B({env:null===(c=bt.options)||void 0===c?void 0:c.env,eventName:_,paymentIntentId:null===(u=null==P?void 0:P.intent)||void 0===u?void 0:u.id,componentName:null==P?void 0:P.type},{intentId:null===(p=null==P?void 0:P.intent)||void 0===p?void 0:p.id,accountId:null==P?void 0:P.accountId}));break;case"on3dsFlowSuccess":Ne(),A?(e=>{const t=new CustomEvent(Ee,{detail:e,bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(P):null===(h=null===(m=null==S?void 0:S.iframe)||void 0===m?void 0:m.contentWindow)||void 0===h||h.postMessage({code:Ee,confirmResult:P},L),B({env:null===(y=bt.options)||void 0===y?void 0:y.env,eventName:"on3dsFlowSuccess",...P},{intentId:null===(w=null==P?void 0:P.intent)||void 0===w?void 0:w.id});break;case"on3dsFlowError":Ne(),A?(e=>{const t=new CustomEvent(Ie,{detail:{error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(P.error):null===(f=null===(g=null==S?void 0:S.iframe)||void 0===g?void 0:g.contentWindow)||void 0===f||f.postMessage({code:Ie,error:P.error},L),B({env:null===(b=bt.options)||void 0===b?void 0:b.env,eventName:"on3dsFlowError",...P},{intentId:null===(C=null==P?void 0:P.intent)||void 0===C?void 0:C.id});break;case"on3dsFlowCancel":if(Ne(),A){(()=>{const e=new CustomEvent(Ce,{bubbles:!0,composed:!0});window.document.dispatchEvent(e)})();break}null===(I=null===(E=null==S?void 0:S.iframe)||void 0===E?void 0:E.contentWindow)||void 0===I||I.postMessage({code:Ce},L)}}),window._airwallexThreeDsListenerFlag=!0,B({env:null===(l=bt.options)||void 0===l?void 0:l.env,eventName:"add3dsEventListener"}))},ke="card",$e=e=>{const{payment_consent_id:t,id:n,customer_id:i,currency:o,latest_payment_attempt:s}=e,{payment_method:a}=s||{},{id:l,card:d}=a||{},{bin:r,last4:v,brand:c}=d||{};return{intent_id:n,payment_consent_id:t||"",customer_id:i||"",currency:o||"",payment_method:{id:l||"",bin:r,last4:v,brand:c}}};class Me extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=ke,this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/card?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex card element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex card element iframe"),this.addResizeListener(ke),window.addEventListener("message",e=>{var t,n,o,s,a,l,d,r,c,u,p,m,y,w,g,f,b,C,E,I,P,A,S,L,x,N,U,k,$,M;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===ke){if("onSubmit"===(null===(n=e.data)||void 0===n?void 0:n.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:ke},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(s=this.domElement)||void 0===s||s.dispatchEvent(t),this.recordLog({eventName:h})}if("onDynamicCurrencyConversion"===(null===(a=e.data)||void 0===a?void 0:a.code)){const t=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:ke},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(d=this.domElement)||void 0===d||d.dispatchEvent(t)}if("onReady"===(null===(r=e.data)||void 0===r?void 0:r.code)){const t=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:ke},bubbles:!0,composed:!0});null===(u=this.domElement)||void 0===u||u.dispatchEvent(t),be({type:ke,popupWidth:null===(p=null==i?void 0:i.style)||void 0===p?void 0:p.popupWidth,popupHeight:null===(m=null==i?void 0:i.style)||void 0===m?void 0:m.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(y=null==bt?void 0:bt.options)||void 0===y?void 0:y.locale}),Ue({popupWidth:null===(w=null==i?void 0:i.style)||void 0===w?void 0:w.popupWidth,popupHeight:null===(g=null==i?void 0:i.style)||void 0===g?void 0:g.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(f=null==bt?void 0:bt.options)||void 0===f?void 0:f.locale}),this.recordLog({eventName:v})}if("onSuccess"===(null===(b=e.data)||void 0===b?void 0:b.code)&&this.success(null===(C=e.data)||void 0===C?void 0:C.intent),"onError"===(null===(E=e.data)||void 0===E?void 0:E.code)&&this.fail(null===(I=e.data)||void 0===I?void 0:I.error),["onFocus","onBlur","onChange"].includes(null===(P=e.data)||void 0===P?void 0:P.code)){const t=new CustomEvent(null===(A=e.data)||void 0===A?void 0:A.code,{detail:{type:ke,complete:null!==(L=null===(S=e.data)||void 0===S?void 0:S.complete)&&void 0!==L&&L,empty:null!==(N=null===(x=e.data)||void 0===x?void 0:x.empty)&&void 0!==N&&N,error:null===(U=e.data)||void 0===U?void 0:U.error,brand:null!==($=null===(k=e.data)||void 0===k?void 0:k.brand)&&void 0!==$?$:""},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(M=this.domElement)||void 0===M||M.dispatchEvent(t)}}})}async confirm(e){var t,n;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:i,intent_id:o,...s}=e||{};return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:{...s,id:i||o}},this.gatewayUrl),this.recordLog({eventName:y,intentId:i||o,data:e}),new Promise((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0})}async createPaymentConsent(e){var t,n;this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!");const{intent_id:i,...o}=e;return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentConsent",data:{...o,intent_id:i}},this.gatewayUrl),this.recordLog({eventName:g,intentId:null==e?void 0:e.intent_id,data:e}),new Promise((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0})}async verifyConsent(e){var t,n;return this.paymentConsent.awaiting&&console.warn("Should waiting previous verifyConsent finished before execute new one!"),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"verifyConsent",data:e},this.gatewayUrl),this.recordLog({eventName:f,data:e}),new Promise((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0})}success(e){let t="";this.confirmIntent.awaiting&&this.confirmIntent.resolver&&(t=x,this.confirmIntent.resolver(e)),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&(t=k,this.paymentConsent.resolver($e(e))),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1,this.recordLog({eventName:c,intent:e,intentId:null==e?void 0:e.id,type:t})}fail(e){let t="";this.confirmIntent.awaiting&&this.confirmIntent.reject&&(this.confirmIntent.reject(e),t=x),this.paymentConsent.awaiting&&this.paymentConsent.reject&&(this.paymentConsent.reject(e),t=k),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},this.recordLog({eventName:u,error:e,severity:"warn",type:t})}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const Re="cardNumber";class je extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=Re,this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},this.binInfo={resolver:null,reject:null,awaiting:!1},null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/card-number?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex card number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex card number element iframe"),this.addResizeListener(Re),window.addEventListener("message",e=>{var t,n,o,s,a,l,d,r,v,u,p,m,y,w,g,f,b,C,I,P,A,S,L,x,N,k,$,M,R,j,_,T,W,D,F,B,O,H,z,q,J,V,K,Q,Z,G,Y,X,ee,te;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===Re){if("onSubmit"===(null===(n=e.data)||void 0===n?void 0:n.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:Re},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(s=this.domElement)||void 0===s||s.dispatchEvent(t),this.recordLog({eventName:h})}if("onDynamicCurrencyConversion"===(null===(a=e.data)||void 0===a?void 0:a.code)){const t=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:Re},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(d=this.domElement)||void 0===d||d.dispatchEvent(t)}if("onReady"===(null===(r=e.data)||void 0===r?void 0:r.code)){const t=new CustomEvent(null===(v=e.data)||void 0===v?void 0:v.code,{detail:{type:null===(u=e.data)||void 0===u?void 0:u.type},bubbles:!0,composed:!0});null===(p=this.domElement)||void 0===p||p.dispatchEvent(t),be({type:Re,popupWidth:null===(m=null==i?void 0:i.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(y=null==i?void 0:i.style)||void 0===y?void 0:y.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(w=null==bt?void 0:bt.options)||void 0===w?void 0:w.locale}),Ue({popupWidth:null===(g=null==i?void 0:i.style)||void 0===g?void 0:g.popupWidth,popupHeight:null===(f=null==i?void 0:i.style)||void 0===f?void 0:f.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(b=null==bt?void 0:bt.options)||void 0===b?void 0:b.locale})}if("onSuccess"===(null===(C=e.data)||void 0===C?void 0:C.code)&&(this.confirmIntent.resolver||this.paymentConsent.resolver)&&this.success(null===(I=e.data)||void 0===I?void 0:I.intent),"onError"===(null===(P=e.data)||void 0===P?void 0:P.code)&&(this.confirmIntent.reject||this.paymentConsent.reject)&&this.fail(null===(A=e.data)||void 0===A?void 0:A.error),"onIntentRetrieved"===(null===(S=e.data)||void 0===S?void 0:S.code)&&this.retrieve.resolver&&this.success(null===(L=e.data)||void 0===L?void 0:L.intent),"onRetrieveIntentError"===(null===(x=e.data)||void 0===x?void 0:x.code)&&(this.fail(null===(N=e.data)||void 0===N?void 0:N.error),this.retrieve.awaiting=!1),"onPaymentMethodCreated"===(null===(k=e.data)||void 0===k?void 0:k.code)&&this.createMethod.resolver&&(this.createMethod.resolver(null===($=e.data)||void 0===$?void 0:$.paymentMethod),this.createMethod.awaiting=!1,this.recordLog({eventName:c,type:U,paymentMethod:null===(M=e.data)||void 0===M?void 0:M.paymentMethod})),"onPaymentMethodCreatedError"===(null===(R=e.data)||void 0===R?void 0:R.code)&&this.fail(null===(j=e.data)||void 0===j?void 0:j.error),"onBinInfoSuccess"===(null===(_=e.data)||void 0===_?void 0:_.code)&&this.binInfo.resolver&&(this.binInfo.resolver(null===(T=e.data)||void 0===T?void 0:T.binInfo),this.binInfo.awaiting=!1,this.binInfo.resolver=null,this.binInfo.reject=null,this.recordLog({eventName:"onBinInfoSuccess",type:E,binInfo:null===(W=e.data)||void 0===W?void 0:W.binInfo})),"onBinInfoError"===(null===(D=e.data)||void 0===D?void 0:D.code)&&this.binInfo.reject&&(this.binInfo.reject(null===(F=e.data)||void 0===F?void 0:F.error),this.binInfo.awaiting=!1,this.binInfo.resolver=null,this.binInfo.reject=null,this.recordLog({eventName:"onBinInfoError",type:E,error:null===(B=e.data)||void 0===B?void 0:B.error})),"onPressArrowKey"===(null===(O=e.data)||void 0===O?void 0:O.code)&&this.pressArrowKey(Re,null===(H=e.data)||void 0===H?void 0:H.arrowKey),["onFocus","onBlur","onChange"].includes(null===(z=e.data)||void 0===z?void 0:z.code)){const t=new CustomEvent(null===(q=e.data)||void 0===q?void 0:q.code,{detail:{type:Re,complete:null!==(V=null===(J=e.data)||void 0===J?void 0:J.complete)&&void 0!==V&&V,empty:null!==(Q=null===(K=e.data)||void 0===K?void 0:K.empty)&&void 0!==Q&&Q,error:null===(Z=e.data)||void 0===Z?void 0:Z.error,brand:null!==(Y=null===(G=e.data)||void 0===G?void 0:G.brand)&&void 0!==Y?Y:"",cardBin:null!==(ee=null===(X=e.data)||void 0===X?void 0:X.cardBin)&&void 0!==ee?ee:""},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(te=this.domElement)||void 0===te||te.dispatchEvent(t)}}})}async confirm(e){var t,n;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:i,intent_id:o,...s}=e||{};return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:{...s,id:i||o}},this.gatewayUrl),this.recordLog({eventName:y,intentId:null==e?void 0:e.intent_id,data:e}),new Promise((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0})}async createPaymentMethod(e){var t,n;this.createMethod.awaiting&&console.warn("Should waiting previous createPaymentMethod finished before execute new one!");const{...i}=e||{};return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentMethod",data:i},this.gatewayUrl),this.recordLog({eventName:b,data:e}),new Promise((e,t)=>{this.createMethod.resolver=e,this.createMethod.reject=t,this.createMethod.awaiting=!0})}async createPaymentConsent(e){var t,n;this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!");const{intent_id:i,...o}=e;return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentConsent",data:{...o,intent_id:i}},this.gatewayUrl),this.recordLog({eventName:g,intentId:null==e?void 0:e.intent_id,data:e}),new Promise((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0})}async verifyConsent(e){var t,n;return this.paymentConsent.awaiting&&console.warn("Should waiting previous verifyConsent finished before execute new one!"),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"verifyConsent",data:e},this.gatewayUrl),this.recordLog({eventName:f,data:e}),new Promise((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0})}async getPaymentIntent(e,t){var n,i;return this.retrieve.awaiting&&console.warn("Should waiting previous getPaymentIntent finished before execute new one!"),null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"getIntent",data:{id:e,client_secret:t}},this.gatewayUrl),this.recordLog({eventName:C,intentId:e}),new Promise((e,t)=>{this.retrieve.resolver=e,this.retrieve.reject=t,this.retrieve.awaiting=!0})}async getBinInfo(e){var t;if(!e||!e.trim())throw console.error("client_secret is required"),new Error("client_secret is required");if(this.binInfo.awaiting)throw console.warn("Should wait for the previous getBinInfo to finish before executing a new one!"),new Error("Previous getBinInfo request is still in progress");if(!(null===(t=this.iframe)||void 0===t?void 0:t.contentWindow))throw console.error("iframe or contentWindow is not available"),new Error("iframe or contentWindow is not available");return this.iframe.contentWindow.postMessage({code:"getBinInfo",data:{client_secret:e}},this.gatewayUrl),this.recordLog({eventName:E}),new Promise((e,t)=>{this.binInfo.resolver=e,this.binInfo.reject=t,this.binInfo.awaiting=!0})}success(e){let t="";this.confirmIntent.awaiting&&this.confirmIntent.resolver&&(this.confirmIntent.resolver(e),t=x),this.retrieve.awaiting&&this.retrieve.resolver&&(this.retrieve.resolver(e),t=N),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&(this.paymentConsent.resolver($e(e)),t=k),this.confirmIntent.awaiting=!1,this.retrieve.awaiting=!1,this.paymentConsent.awaiting=!1,this.recordLog({eventName:c,intentId:null==e?void 0:e.id,type:t,intent:e})}fail(e){let t="";this.confirmIntent.awaiting&&this.confirmIntent.reject&&(this.confirmIntent.reject(e),t=x),this.retrieve.awaiting&&this.retrieve.reject&&(this.retrieve.reject(e),t=N),this.createMethod.awaiting&&this.createMethod.reject&&(this.createMethod.reject(e),t=U),this.paymentConsent.awaiting&&this.paymentConsent.reject&&(this.paymentConsent.reject(e),t=k),this.binInfo.awaiting&&this.binInfo.reject&&(this.binInfo.reject(e),t=E),this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},this.binInfo={resolver:null,reject:null,awaiting:!1},this.recordLog({eventName:u,error:e,severity:"warn",type:t})}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const _e="expiry";class Te extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=_e,null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/expiry?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex expiry number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex expiry number element iframe"),this.addResizeListener(_e),window.addEventListener("message",e=>{var t,n,i,o,s,a,l,d,r,v,c,u,p,m,h;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===_e){if("onReady"===(null===(n=e.data)||void 0===n?void 0:n.code)){const t=new CustomEvent(null===(i=e.data)||void 0===i?void 0:i.code,{detail:{type:null===(o=e.data)||void 0===o?void 0:o.type},bubbles:!0,composed:!0});null===(s=this.domElement)||void 0===s||s.dispatchEvent(t)}if(["onFocus","onBlur","onChange"].includes(null===(a=e.data)||void 0===a?void 0:a.code)){const t=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:_e,complete:null!==(r=null===(d=e.data)||void 0===d?void 0:d.complete)&&void 0!==r&&r,empty:null!==(c=null===(v=e.data)||void 0===v?void 0:v.empty)&&void 0!==c&&c,error:null===(u=e.data)||void 0===u?void 0:u.error},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(p=this.domElement)||void 0===p||p.dispatchEvent(t)}"onPressArrowKey"===(null===(m=e.data)||void 0===m?void 0:m.code)&&this.pressArrowKey(_e,null===(h=e.data)||void 0===h?void 0:h.arrowKey)}})}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const We="cvc";class De extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=We,this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/cvc?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex cvc number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex cvc number element iframe"),this.addResizeListener("cvc"),window.addEventListener("message",e=>{var t,n,o,s,a,l,d,r,c,u,p,m,y,w,g,f,b,C,E,I,P,A,S,L,x,N,U,k,$,M,R,j,_,T,W;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===We){if("onSubmit"===(null===(n=e.data)||void 0===n?void 0:n.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:We},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(s=this.domElement)||void 0===s||s.dispatchEvent(t),this.recordLog({eventName:h})}if("onDynamicCurrencyConversion"===(null===(a=e.data)||void 0===a?void 0:a.code)){const t=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:We},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(d=this.domElement)||void 0===d||d.dispatchEvent(t)}if("onReady"===(null===(r=e.data)||void 0===r?void 0:r.code)){const t=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:null===(u=e.data)||void 0===u?void 0:u.type},bubbles:!0,composed:!0});null===(p=this.domElement)||void 0===p||p.dispatchEvent(t),this.recordLog({eventName:v}),be({type:We,popupWidth:null===(m=null==i?void 0:i.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(y=null==i?void 0:i.style)||void 0===y?void 0:y.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(w=null==bt?void 0:bt.options)||void 0===w?void 0:w.locale}),Ue({popupWidth:null===(g=null==i?void 0:i.style)||void 0===g?void 0:g.popupWidth,popupHeight:null===(f=null==i?void 0:i.style)||void 0===f?void 0:f.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(b=null==bt?void 0:bt.options)||void 0===b?void 0:b.locale})}if("onSuccess"===(null===(C=e.data)||void 0===C?void 0:C.code)&&(this.confirmIntent.resolver||this.paymentConsent.resolver)&&this.success(null===(E=e.data)||void 0===E?void 0:E.intent),"onError"===(null===(I=e.data)||void 0===I?void 0:I.code)&&(this.confirmIntent.reject||this.paymentConsent.reject)&&this.fail(null===(P=e.data)||void 0===P?void 0:P.error),["onFocus","onBlur","onChange"].includes(null===(A=e.data)||void 0===A?void 0:A.code)){const t=new CustomEvent(null===(S=e.data)||void 0===S?void 0:S.code,{detail:{type:We,complete:null!==(x=null===(L=e.data)||void 0===L?void 0:L.complete)&&void 0!==x&&x,empty:null!==(U=null===(N=e.data)||void 0===N?void 0:N.empty)&&void 0!==U&&U,error:null===(k=e.data)||void 0===k?void 0:k.error},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===($=this.domElement)||void 0===$||$.dispatchEvent(t)}"onPressArrowKey"===(null===(M=e.data)||void 0===M?void 0:M.code)&&this.pressArrowKey(We,null===(R=e.data)||void 0===R?void 0:R.arrowKey)}e.origin===this.gatewayUrl&&e.isTrusted&&"cardNumber"===(null===(j=e.data)||void 0===j?void 0:j.type)&&"onChange"===(null===(_=e.data)||void 0===_?void 0:_.code)&&(null===(W=null===(T=this.iframe)||void 0===T?void 0:T.contentWindow)||void 0===W||W.postMessage({code:"update",options:{cvcLength:e.data.cvcLength}},this.gatewayUrl))})}async confirm(e){var t,n;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:i,intent_id:o,...s}=e||{};return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:{...s,id:i||o}},this.gatewayUrl),this.recordLog({eventName:y,intentId:null==e?void 0:e.intent_id,data:e}),new Promise((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0})}async createPaymentConsent(e){var t,n;this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!");const{intent_id:i,...o}=e;return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentConsent",data:{...o,intent_id:i}},this.gatewayUrl),this.recordLog({eventName:g,intentId:null==e?void 0:e.intent_id,data:e}),new Promise((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0})}success(e){let t="";this.confirmIntent.resolver&&(this.confirmIntent.resolver(e),t=x),this.paymentConsent.resolver&&(this.paymentConsent.resolver($e(e)),t=k),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1,this.recordLog({eventName:c,intent:e,intentId:null==e?void 0:e.id,type:t})}fail(e){let t="";this.confirmIntent.awaiting&&this.confirmIntent.reject&&(this.confirmIntent.reject(e),t=x),this.paymentConsent.awaiting&&this.paymentConsent.reject&&(this.paymentConsent.reject(e),t=k),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},this.recordLog({eventName:u,error:e,severity:"warn",type:t})}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}class Fe extends q{constructor(e,t,n,i,o){super(e,o),this.elementTypeString=n,this.elementType=n,this.setupIframe(e,t,i,n),this.addResizeListener(n),this.setupMessageListener()}setupIframe(e,n,i,o){var s,a,l,d,r;null===(s=this.iframe)||void 0===s||s.setAttribute("src",`${e}/#/elements/${i}?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(a=bt.options)||void 0===a?void 0:a.fonts}))}&lang=${null===(l=bt.options)||void 0===l?void 0:l.locale}&appVersion=${null==t?void 0:t.version}`),null===(d=this.iframe)||void 0===d||d.setAttribute("name",`Airwallex ${o} element iframe`),null===(r=this.iframe)||void 0===r||r.setAttribute("title",`Airwallex ${o} element iframe`)}setupMessageListener(){this.messageListener=e=>{var t;e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===this.elementTypeString&&this.handleInnerMessage(e),this.onCrossElementMessage(e)},window.addEventListener("message",this.messageListener)}handleInnerMessage(e){var t;const{code:n}=e.data;"onReady"===n&&(this.handleReadyEvent(e),this.onElementReady(e)),["onFocus","onBlur","onChange"].includes(n)&&this.onFocusBlurChangeEvent(e),"onPressArrowKey"===n&&this.pressArrowKey(this.elementTypeString,null===(t=e.data)||void 0===t?void 0:t.arrowKey),this.onInnerCustomMessage(e)}handleReadyEvent(e){var t,n,i;const o=new CustomEvent(null===(t=e.data)||void 0===t?void 0:t.code,{detail:{type:null===(n=e.data)||void 0===n?void 0:n.type},bubbles:!0,composed:!0});null===(i=this.domElement)||void 0===i||i.dispatchEvent(o)}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}onFocusBlurChangeEvent(e){var t,n,i,o,s,a,l;const d=new CustomEvent(null===(t=e.data)||void 0===t?void 0:t.code,{detail:{type:this.elementTypeString,complete:null!==(i=null===(n=e.data)||void 0===n?void 0:n.complete)&&void 0!==i&&i,empty:null!==(s=null===(o=e.data)||void 0===o?void 0:o.empty)&&void 0!==s&&s,error:null===(a=e.data)||void 0===a?void 0:a.error},bubbles:!0,composed:!0});window.document.dispatchEvent(d),null===(l=this.domElement)||void 0===l||l.dispatchEvent(d)}onCrossElementMessage(e){}onElementReady(e){}onInnerCustomMessage(e){}destroy(){this.messageListener&&(window.removeEventListener("message",this.messageListener),this.messageListener=void 0),super.destroy()}}const Be="krCardExpiry";class Oe extends Fe{constructor(e,t,n){super(e,t,Be,"kr-card-expiry",n),this.elementType=Be}}const He="krCardPswFirst2";class ze extends Fe{constructor(e,t,n){super(e,t,He,"kr-card-psw-first-2",n),this.elementType=He}}const qe="krCardIdentifier";class Je extends Fe{constructor(e,t,n){super(e,t,qe,"kr-card-identifier",n),this.elementType=qe}}const Ve="krCardNumber";class Ke extends Fe{constructor(e,t,n){super(e,t,Ve,"kr-card-number",n),this.elementType=Ve,this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.options=n}onInnerCustomMessage(e){var t,n,i,o;const{code:s}=e.data;if("onSubmit"===s){const e=new CustomEvent(s,{detail:{type:Ve},bubbles:!0,composed:!0});window.document.dispatchEvent(e),null===(t=this.domElement)||void 0===t||t.dispatchEvent(e),this.recordLog({eventName:h})}if("onDynamicCurrencyConversion"===s){const e=new CustomEvent(s,{detail:{type:Ve},bubbles:!0,composed:!0});window.document.dispatchEvent(e),null===(n=this.domElement)||void 0===n||n.dispatchEvent(e)}"onSuccess"===s&&this.confirmIntent.resolver&&this.success(null===(i=e.data)||void 0===i?void 0:i.intent),"onError"===s&&this.confirmIntent.reject&&this.fail(null===(o=e.data)||void 0===o?void 0:o.error)}onFocusBlurChangeEvent(e){var t,n,i,o,s,a,l,d,r,v,c;const u=new CustomEvent(null===(t=e.data)||void 0===t?void 0:t.code,{detail:{type:Ve,complete:null!==(i=null===(n=e.data)||void 0===n?void 0:n.complete)&&void 0!==i&&i,empty:null!==(s=null===(o=e.data)||void 0===o?void 0:o.empty)&&void 0!==s&&s,error:null===(a=e.data)||void 0===a?void 0:a.error,brand:null!==(d=null===(l=e.data)||void 0===l?void 0:l.brand)&&void 0!==d?d:"",cardBin:null!==(v=null===(r=e.data)||void 0===r?void 0:r.cardBin)&&void 0!==v?v:""},bubbles:!0,composed:!0});window.document.dispatchEvent(u),null===(c=this.domElement)||void 0===c||c.dispatchEvent(u)}async confirm(e){var t,n;if(this.confirmIntent.awaiting)return Promise.reject(new Error("Should waiting previous confirm finished before execute new one!"));const{id:i,intent_id:o,...s}=e||{};return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:{...s,id:i||o}},this.gatewayUrl),this.recordLog({eventName:y,intentId:null==e?void 0:e.intent_id,data:e}),new Promise((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0})}success(e){let t="";this.confirmIntent.awaiting&&this.confirmIntent.resolver&&(this.confirmIntent.resolver(e),t=x),this.confirmIntent.awaiting=!1,this.recordLog({eventName:c,intentId:null==e?void 0:e.id,type:t,intent:e})}fail(e){let t="";this.confirmIntent.awaiting&&this.confirmIntent.reject&&(this.confirmIntent.reject(e),t=x),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.recordLog({eventName:u,error:e,severity:"warn",type:t})}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const Qe=e=>{e.startsWith("http")?window.location.href=e:window.open(e)};class Ze{constructor({width:e="100%",height:t="100%",borderRadius:n="6px",repeatCount:i=1,margin:o=""}){const s=window.document.createElement("style");s.textContent="\n    @keyframes MuiSkeleton-keyframes-pulse {\n        0% {\n          opacity: 1;\n        }\n        50% {\n          opacity: 0.4;\n        }\n        100% {\n          opacity: 1;\n        }\n      }";const a=window.document.createElement("div");a.appendChild(s),a.setAttribute("id","loading"),[...Array(i)].forEach((s,l)=>{const d=window.document.createElement("div");d.setAttribute("style",`width: ${e};\n         height:${t};\n         border-radius:${n};\n         margin:${l===i-1?"":o};\n         background-color:#EBECF0;\n         animation: MuiSkeleton-keyframes-pulse 1.5s ease-in-out 0.5s infinite;`),a.appendChild(d)}),this.domElement=a}getDomElement(){return this.domElement}}let Ge=null;const Ye="dropIn";class Xe extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=Ye,this.applePayPaymentData=void 0;const{applePayRequestOptions:r}=i||{};this.applePayRequestOptions=r,null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/dropin?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,applePayRequestOptions:this.applePayRequestOptions,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex dropIn element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex dropIn element iframe"),this.addResizeListener(Ye),this.iframe&&(e=>{window.addEventListener("message",t=>{var n,i;["https://checkout-dev.airwallex.com","https://checkout-staging.airwallex.com","https://checkout-demo.airwallex.com","https://checkout.airwallex.com"].includes(t.origin)&&"plaidPopupIframe"===(null===(n=t.data)||void 0===n?void 0:n.type)&&(Ge&&(Ge.style.display="none"),e&&(null===(i=e.contentWindow)||void 0===i||i.postMessage(t.data,t.origin)))})})(this.iframe),this.listenerFunc=e=>{var t,n,o,s,a,l,d,r,v,c,u,p,m,h,y,w,g,f,b,C,E,I;try{if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===Ye)switch(null===(n=e.data)||void 0===n?void 0:n.code){case"onReady":St&&(null===(s=null===(o=this.iframe)||void 0===o?void 0:o.contentWindow)||void 0===s||s.postMessage({code:"onApplePaySDKBlocked"},this.gatewayUrl)),be({type:Ye,popupWidth:null===(a=null==i?void 0:i.style)||void 0===a?void 0:a.popupWidth,popupHeight:null===(l=null==i?void 0:i.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(d=null==bt?void 0:bt.options)||void 0===d?void 0:d.locale}),Ue({popupWidth:null===(r=null==i?void 0:i.style)||void 0===r?void 0:r.popupWidth,popupHeight:null===(v=null==i?void 0:i.style)||void 0===v?void 0:v.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(c=null==bt?void 0:bt.options)||void 0===c?void 0:c.locale,loadingColor:null===(p=null===(u=null==i?void 0:i.theme)||void 0===u?void 0:u.palette)||void 0===p?void 0:p.primary}),this.removeLoading(),this.ready();break;case"onRedirect":{const{redirectUrl:t}=null!==(h=null===(m=e.data)||void 0===m?void 0:m.redirectPayload)&&void 0!==h?h:{};t&&Qe(t);break}case"onSuccess":if(this.session){const e={status:ApplePaySession.STATUS_SUCCESS};null===(y=this.session)||void 0===y||y.completePayment(e)}this.success(null===(w=e.data)||void 0===w?void 0:w.intent,null===(g=e.data)||void 0===g?void 0:g.consent);break;case"onError":if(this.session){if(this.applePayPaymentData){const e={status:ApplePaySession.STATUS_FAILURE};null===(b=this.session)||void 0===b||b.completePayment(e)}else null===(f=this.session)||void 0===f||f.abort();this.session=void 0}this.fail(null===(C=e.data)||void 0===C?void 0:C.error);break;case"onPendingVerifyAccount":this.pendingVerifyAccount(e.data.intent,null===(E=e.data.directDebit)||void 0===E?void 0:E.url);break;case"onClickConfirmButton":this.clickConfirmButton();break;case"onSwitchMethod":this.switchMethod({method:e.data.method,methodName:e.data.methodName,surchargeFee:e.data.surchargeFee});break;case"onApplePayButtonClick":this.session||(this.session=new ApplePaySession(4,e.data.res)),T({useApplePaySDK:e.data.useApplePaySDK,displayApplePayButtonQrCode:e.data.displayApplePayButtonQrCode,displayApplePayButtonOriginal:e.data.displayApplePayButtonOriginal}),this.session.begin(),this.session.onvalidatemerchant=async e=>{var t,n;const i=e.validationURL;null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onvalidatemerchant",validationURL:i},this.gatewayUrl)},this.session.onpaymentauthorized=e=>{var t,n;this.applePayPaymentData=e.payment,null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onpaymentauthorized",token:e.payment.token,billingContact:e.payment.billingContact,shippingContact:e.payment.shippingContact},this.gatewayUrl)},this.session.oncancel=e=>{this.session=void 0,this.cancel(e)},this.recordLog({eventName:L,data:e.data});break;case"onApplePayValidateSuccess":null===(I=this.session)||void 0===I||I.completeMerchantValidation(e.data.res);break;case"onCreatePlaidPopupIframe":(async e=>{if(Ge)return;const t=document.createElement("iframe");t.src=`${e}/#/page/plaid-popup-iframe?origin=${window.location.origin}`,t.id="airwallex-plaid-oauth",t.setAttribute("frameborder","0"),t.setAttribute("allowtransparency","true"),t.setAttribute("importance","high"),t.setAttribute("scrolling","no"),t.setAttribute("allowpaymentrequest","true"),t.setAttribute("style","\n    position: fixed;\n    left: 0;\n    top: 0;\n    width: 100vw;\n    height: 100vh;\n    display: none;\n    z-index: 10000;\n  "),document.body.appendChild(t),Ge=t,new Promise(e=>{window.addEventListener("message",t=>{var n,i;["https://checkout-staging.airwallex.com","https://checkout-demo.airwallex.com","https://checkout.airwallex.com"].includes(t.origin)&&"plaidPopupIframe"===(null===(n=t.data)||void 0===n?void 0:n.type)&&"onPlaidReady"===(null===(i=t.data)||void 0===i?void 0:i.code)&&e(!0)})})})(this.gatewayUrl);break;case"onPlaidStart":(({data:e,origin:t})=>{var n;Ge&&(Ge&&(Ge.style.display="block"),null===(n=Ge.contentWindow)||void 0===n||n.postMessage(e,t))})({data:e.data,origin:this.gatewayUrl});break;case"onQuoteCreate":this.createQuote(e.data.quote);break;case"onAvailablePaymentMethodsChange":this.handleAvailablePaymentMethodsChange(e.data.availablePaymentMethods)}}catch(e){this.session=void 0,console.error(e)}},window.addEventListener("popstate",()=>{window.removeEventListener("message",this.listenerFunc)}),window.addEventListener("message",this.listenerFunc)}mount(e){const t=new Ze({width:"100%",height:"42px",margin:"0px 0px 20px 0px",repeatCount:3}).getDomElement();if("string"!=typeof e)return(null==e?void 0:e.hasChildNodes())&&(e.innerHTML=""),e.append(t||"",this.iframe||""),s(),this.domElement=e,e;{const n=window.document.getElementById(e);return(null==n?void 0:n.hasChildNodes())&&(n.innerHTML=""),null==n||n.append(t||"",this.iframe||""),s(),n&&(this.domElement=n),n}}removeLoading(){var e;const t=null===(e=this.domElement)||void 0===e?void 0:e.querySelector("#loading");this.domElement&&t&&t.remove()}clickConfirmButton(){var e;const t=new CustomEvent("onClickConfirmButton",{detail:{type:Ye},bubbles:!0,composed:!0});this.recordLog({eventName:m}),window.document.dispatchEvent(t),null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)}ready(){var e;const t=new CustomEvent("onReady",{detail:{type:Ye},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(e=this.domElement)||void 0===e||e.dispatchEvent(t),this.recordLog({eventName:v})}success(e,t){var n;const i=new CustomEvent("onSuccess",{detail:{type:Ye,intent:e,consent:t},bubbles:!0,composed:!0});window.document.dispatchEvent(i),null===(n=this.domElement)||void 0===n||n.dispatchEvent(i),this.recordLog({eventName:c,intent:e,intentId:null==e?void 0:e.id,consent:t})}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:Ye,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:u,error:e,severity:"warn"})}cancel(e){var t;const n=new CustomEvent("onCancel",{detail:{type:Ye,event:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:p,event:n,severity:"info"})}pendingVerifyAccount(e,t){var n;const i=new CustomEvent("onPendingVerifyAccount",{detail:{type:Ye,intent:e,url:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(i),window.document.dispatchEvent(i),this.recordLog({eventName:"onPendingVerifyAccount",intent:e,url:t,intentId:null==e?void 0:e.id})}switchMethod({method:e,methodName:t,surchargeFee:n}){var i;const o=new CustomEvent("onSwitchMethod",{detail:{type:Ye,method:e,methodName:t,surchargeFee:n},bubbles:!0,composed:!0});null===(i=this.domElement)||void 0===i||i.dispatchEvent(o)}createQuote(e){var t;const n=new CustomEvent("onQuoteCreate",{detail:{type:Ye,quote:e},bubbles:!0,composed:!0});this.recordLog({eventName:"onQuoteCreate",quote:e}),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}handleAvailablePaymentMethodsChange(e){var t;const n=new CustomEvent("onAvailablePaymentMethodsChange",{detail:{type:Ye,availablePaymentMethods:e},bubbles:!0,composed:!0});this.recordLog({eventName:"onAvailablePaymentMethodsChange",availablePaymentMethods:e,severity:"verbose"}),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}destroy(){super.destroy(),this.recordLog({eventName:I}),window.removeEventListener("message",this.listenerFunc)}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const et="fullFeaturedCard";class tt extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=et,null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/full-featured-card?options=${encodeURIComponent(JSON.stringify({...i,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex full featured card element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex full featured card element iframe"),this.addResizeListener(et),window.addEventListener("message",e=>{var t,n,o,s,a,l,d,r,c,u,p,m,h,y,w,g;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===et)if("onReady"===(null===(n=e.data)||void 0===n?void 0:n.code)){be({type:et,popupWidth:null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(s=null==i?void 0:i.style)||void 0===s?void 0:s.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(a=null==bt?void 0:bt.options)||void 0===a?void 0:a.locale}),Ue({popupWidth:null===(l=null==i?void 0:i.style)||void 0===l?void 0:l.popupWidth,popupHeight:null===(d=null==i?void 0:i.style)||void 0===d?void 0:d.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(r=null==bt?void 0:bt.options)||void 0===r?void 0:r.locale});const t=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:null===(u=e.data)||void 0===u?void 0:u.type},bubbles:!0,composed:!0});null===(p=this.domElement)||void 0===p||p.dispatchEvent(t),this.recordLog({eventName:v})}else"onSuccess"===(null===(m=e.data)||void 0===m?void 0:m.code)?this.success(null===(h=e.data)||void 0===h?void 0:h.intent):"onError"===(null===(y=e.data)||void 0===y?void 0:y.code)?this.fail(null===(w=e.data)||void 0===w?void 0:w.error):"onCancel"===(null===(g=e.data)||void 0===g?void 0:g.code)&&this.cancel()})}success(e){var t;const n=new CustomEvent("onSuccess",{detail:{type:et,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:c,intent:e,intentId:null==e?void 0:e.id})}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:et,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:u,error:e,severity:"warn"})}cancel(){var e;const t=new CustomEvent("onCancel",{detail:{type:et},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const nt="wechat";class it extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=nt,null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/wechat?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex wechat element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex wechat element iframe"),this.addResizeListener(nt),window.addEventListener("message",e=>{var t,n,i,o,s,a,l,d;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===nt)if("onRedirect"===(null===(n=e.data)||void 0===n?void 0:n.code)){const{redirectUrl:t}=null!==(o=null===(i=e.data)||void 0===i?void 0:i.redirectPayload)&&void 0!==o?o:{};t&&(window.location.href=t)}else"onSuccess"===(null===(s=e.data)||void 0===s?void 0:s.code)?this.success(null===(a=e.data)||void 0===a?void 0:a.intent):"onError"===(null===(l=e.data)||void 0===l?void 0:l.code)?this.fail(e.data.error):"onReady"===(null===(d=e.data)||void 0===d?void 0:d.code)&&this.ready()})}success(e){var t;const n=new CustomEvent("onSuccess",{detail:{type:nt,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:c,intent:e,intentId:null==e?void 0:e.id})}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:nt,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:u,error:e,severity:"warn"})}ready(){var e;const t=new CustomEvent("onReady",{detail:{type:nt},bubbles:!1,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const ot="qrcode";class st extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=ot,null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/qrcode?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex qrcode element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex qrcode element iframe"),this.addResizeListener(ot),window.addEventListener("message",e=>{var t,n,i,o,s,a,l;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===ot)if("onSuccess"===(null===(n=e.data)||void 0===n?void 0:n.code))this.success(null===(i=e.data)||void 0===i?void 0:i.intent);else if("onError"===(null===(o=e.data)||void 0===o?void 0:o.code))this.fail(e.data.error);else if("onRedirect"===(null===(s=e.data)||void 0===s?void 0:s.code)){const{redirectUrl:t}=null!==(l=null===(a=e.data)||void 0===a?void 0:a.redirectPayload)&&void 0!==l?l:{};t&&(window.location.href=t)}})}success(e){var t;const n=new CustomEvent("onSuccess",{detail:{type:ot,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:c,intent:e,intentId:null==e?void 0:e.id})}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:ot,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const at="redirect";class lt extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=at,null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/redirect?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex redirect element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex redirect element iframe"),this.addResizeListener("redirect"),window.addEventListener("message",e=>{var t,n,o,s,a,l,d,r;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===at)if("onRedirect"===(null===(n=e.data)||void 0===n?void 0:n.code)){const{redirectUrl:t,method:n,formData:a}=null!==(s=null===(o=e.data)||void 0===o?void 0:o.redirectPayload)&&void 0!==s?s:{};n===(null==i?void 0:i.method)&&(a?((e,t)=>{const n=document.createElement("form");n.setAttribute("method","post"),n.setAttribute("style","height: 0; overflow: hidden;"),n.action=t,Object.keys(e||{}).forEach(t=>{const i=document.createElement("input");i.type="hidden",i.name=t,i.value=e[t],n.appendChild(i)});const i=document.createElement("input");i.type="submit",n.appendChild(i),document.body.appendChild(n),i.click()})(a,t):Qe(t))}else"onError"===(null===(a=e.data)||void 0===a?void 0:a.code)?this.fail(e.data.error):"onSuccess"===(null===(l=e.data)||void 0===l?void 0:l.code)&&this.success(null===(d=e.data)||void 0===d?void 0:d.intent,null===(r=e.data)||void 0===r?void 0:r.consent)})}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:at,error:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),window.document.dispatchEvent(n),this.recordLog({eventName:u,error:e,severity:"warn"})}success(e,t){var n;const i=new CustomEvent("onSuccess",{detail:{type:at,intent:e,consent:t},bubbles:!0,composed:!0});window.document.dispatchEvent(i),null===(n=this.domElement)||void 0===n||n.dispatchEvent(i),this.recordLog({eventName:c,intent:e,consent:t,intentId:null==e?void 0:e.id})}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}const dt=e=>(e||"").includes("://")?encodeURIComponent(e):encodeURIComponent(`https://${e}`),rt=e=>"string"==typeof e,vt=e=>"boolean"==typeof e,ct=e=>"string"==typeof e,ut=e=>"object"==typeof e&&null!==e,pt={intent_id:{validate:rt,format:e=>`${e}`},consent_id:{validate:rt,format:e=>`${e}`},client_secret:{validate:rt,format:e=>`${e}`},theme:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},customer_id:{validate:rt,format:e=>`${e}`},components:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},payment_consent:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},methods:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},autoCapture:{validate:vt,format:e=>`${e}`},cvcRequired:{validate:vt,format:e=>`${e}`},authorizationType:{validate:e=>"pre_auth"===e||"final_auth"===e,format:e=>`${e}`},successUrl:{validate:ct,format:e=>dt(`${e}`)},failUrl:{validate:ct,format:e=>dt(`${e}`)},logoUrl:{validate:ct,format:e=>dt(`${e}`)},locale:{validate:rt,format:e=>`${e}`},withBilling:{validate:vt,format:e=>`${e}`},mode:{validate:rt,format:e=>`${e}`},wechatpay:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},applePayRequestOptions:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},googlePayRequestOptions:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},requiredBillingContactFields:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},merchantId:{validate:rt,format:e=>`${e}`},recurringOptions:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},currency:{validate:rt,format:e=>`${e}`},country_code:{validate:rt,format:e=>`${e}`},shopper_name:{validate:rt,format:e=>`${e}`},shopper_phone:{validate:rt,format:e=>`${e}`},shopper_email:{validate:rt,format:e=>`${e}`},showTermLink:{validate:vt,format:e=>`${e}`},platformConnectedAccount:{validate:rt,format:e=>`${e}`},allowedCardNetworks:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},autoSaveCardForFuturePayments:{validate:vt,format:e=>`${e}`},layout:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},appearance:{validate:ut,format:e=>encodeURIComponent(JSON.stringify(e))},submitType:{validate:rt,format:e=>`${e}`}};class mt extends q{constructor(e,t,n){var i,o,s,a,l;super(e,n),null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/frame/popup?options=${encodeURIComponent(JSON.stringify({...this.options,...t}))}`),null===(o=this.iframe)||void 0===o||o.setAttribute("name","Airwallex action popup"),null===(s=this.iframe)||void 0===s||s.setAttribute("title","Airwallex action popup"),null===(a=this.iframe)||void 0===a||a.setAttribute("scrolling","yes"),null===(l=this.iframe)||void 0===l||l.setAttribute("style","\n      display: none;\n      width: 100%;\n      height: 100%;\n      position: fixed;\n      top: 0;\n      left: 0;\n      z-index: 10000;\n      ")}}const ht="googlePayButton";class yt extends q{constructor(e,n,i){var o,s,a,l,d;super(e,i),this.elementType=ht,this.confirmIntentPromise={resolver:null,reject:null,awaiting:!1},this.paymentConsentPromise={resolver:null,reject:null,awaiting:!1};const{amount:r,countryCode:v}=this.options;r&&v?(null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/google-pay?options=${encodeURIComponent(JSON.stringify({...this.options,sessionId:n,fonts:null===(s=bt.options)||void 0===s?void 0:s.fonts}))}&lang=${null===(a=bt.options)||void 0===a?void 0:a.locale}&appVersion=${null==t?void 0:t.version}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex google pay button iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex google pay button iframe")):(console.warn("please check the required options of google pay button element"),this.ready()),this.addResizeListener(ht),this.listenerFunc=e=>{var t,n,o,s,a,l,d,r,v,c,u,p,m,h,y;try{if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===ht)switch(null===(n=e.data)||void 0===n?void 0:n.code){case"onReady":be({type:ht,popupWidth:null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(s=null==i?void 0:i.style)||void 0===s?void 0:s.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(a=null==bt?void 0:bt.options)||void 0===a?void 0:a.locale}),Ue({popupWidth:null===(l=null==i?void 0:i.style)||void 0===l?void 0:l.popupWidth,popupHeight:null===(d=null==i?void 0:i.style)||void 0===d?void 0:d.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(r=null==bt?void 0:bt.options)||void 0===r?void 0:r.locale}),this.ready();break;case"onSuccess":this.success(null===(v=e.data)||void 0===v?void 0:v.intent,null===(c=e.data)||void 0===c?void 0:c.consent);break;case"onAuthorized":this.authorized(null===(u=e.data)||void 0===u?void 0:u.paymentData);break;case"onShippingAddressChange":this.shippingAddressChange(null===(p=e.data)||void 0===p?void 0:p.paymentData);break;case"onShippingMethodChange":this.shippingMethodChange(null===(m=e.data)||void 0===m?void 0:m.paymentData);break;case"onGooglePayButtonClick":this.click();break;case"onCancel":this.cancel(null===(h=e.data)||void 0===h?void 0:h.intent);break;case"onError":this.fail(null===(y=e.data)||void 0===y?void 0:y.error)}}catch(e){console.error(e)}},window.addEventListener("popstate",()=>{window.removeEventListener("message",this.listenerFunc)}),window.addEventListener("message",this.listenerFunc)}click(){var e;const t=new CustomEvent("onClick",{detail:{type:ht},bubbles:!0,composed:!0});this.recordLog({eventName:"onGooglePayButtonClick"}),null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)}ready(){var e;const t=new CustomEvent("onReady",{detail:{type:ht},bubbles:!0,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t),this.recordLog({eventName:v})}cancel(e){var t;const n=new CustomEvent("onCancel",{detail:{type:ht,intent:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}success(e,t){var n;let i="";if(this.confirmIntentPromise.awaiting&&this.confirmIntentPromise.resolver)this.confirmIntentPromise.resolver(e),i=x;else if(this.paymentConsentPromise.awaiting&&this.paymentConsentPromise.resolver)this.paymentConsentPromise.resolver(t),i=g;else{const i=new CustomEvent("onSuccess",{detail:{type:ht,intent:e,consent:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(i)}this.recordLog({eventName:c,intent:e,consent:t,intentId:null==e?void 0:e.id,type:i})}fail(e){var t;let n="";if(this.confirmIntentPromise.awaiting&&this.confirmIntentPromise.reject)this.confirmIntentPromise.reject(e),n=x;else if(this.paymentConsentPromise.awaiting&&this.paymentConsentPromise.reject)this.paymentConsentPromise.reject(e),n=k;else{const n=new CustomEvent("onError",{detail:{type:ht,error:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}this.recordLog({eventName:u,error:e,severity:"warn",type:n})}authorized(e){var t;const n=new CustomEvent("onAuthorized",{detail:{type:ht,paymentData:e},bubbles:!0,composed:!0});this.recordLog({eventName:P,paymentData:e}),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}async confirmIntent(e){var t,n;return this.confirmIntentPromise.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!"),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",options:e},this.gatewayUrl),this.recordLog({eventName:y}),new Promise((e,t)=>{this.confirmIntentPromise.resolver=e,this.confirmIntentPromise.reject=t,this.confirmIntentPromise.awaiting=!0})}async createPaymentConsent(e){var t,n;return this.paymentConsentPromise.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!"),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentConsent",options:{...e,mode:"recurring"}},this.gatewayUrl),this.recordLog({eventName:g}),new Promise((e,t)=>{this.paymentConsentPromise.resolver=e,this.paymentConsentPromise.reject=t,this.paymentConsentPromise.awaiting=!0})}shippingAddressChange(e){var t;const n=new CustomEvent("onShippingAddressChange",{detail:{type:ht,intermediatePaymentData:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:A,intermediatePaymentData:e})}shippingMethodChange(e){var t;const n=new CustomEvent("onShippingMethodChange",{detail:{type:ht,intermediatePaymentData:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),this.recordLog({eventName:S,intermediatePaymentData:e})}destroy(){super.destroy(),this.recordLog({eventName:I}),window.removeEventListener("message",this.listenerFunc)}on(e,t){var n;this.listeners[e]=t,null===(n=this.domElement)||void 0===n||n.addEventListener(O(e),t),this.recordLog({eventName:w,event:e})}}var wt;const gt=["cardNumber","krCardNumber","expiry","cvc","card","wechat","qrcode","redirect","dropIn","fullFeaturedCard","applePayButton","googlePayButton","directDebit","krCardExpiry","krCardPswFirst2","krCardIdentifier"],ft=[...gt,"threeDsFrictionless","threeDsChallenge","threeDs","popup"],bt={gatewayUrl:i("prod"),options:{env:"prod",origin:null===(wt=null===window||void 0===window?void 0:window.location)||void 0===wt?void 0:wt.origin}},Ct={cardNumber:null,krCardNumber:null,expiry:null,cvc:null,threeDsFrictionless:null,threeDsChallenge:null,card:null,wechat:null,qrcode:null,redirect:null,dropIn:null,fullFeaturedCard:null,applePayButton:null,popup:null,krCardExpiry:null,krCardPswFirst2:null,krCardIdentifier:null};let Et=null;const It=e=>{(null==e?void 0:e.env)&&(bt.gatewayUrl=i(null==e?void 0:e.env)),bt.options={...bt.options,...e}},Pt=e=>{var n,o;B({env:null===(n=bt.options)||void 0===n?void 0:n.env,eventName:"redirectToCheckout",props:e},{elementType:"hpp",intentId:null==e?void 0:e.intent_id});const{env:s,disableAutoRedirect:a,...l}=e,d=(e=>{const t={};return Object.keys(pt).forEach(n=>{const i=e[n];if(null!==i&&""!==i&&pt[n].validate(i)){if(["successUrl","failUrl"].includes(n)&&i&&((o=`${i}`).includes("<script>")||o.includes("<\/script>")||o.includes("javascript:")))return void console.warn(`${n} is not a valid url`);if(["logoUrl"].includes(n)&&i&&!(e=>null!==e.match(/^(https?):\/\/(?:www\.)?([a-zA-Z0-9-.]+\.)([a-zA-Z]{2,})(\/[a-zA-Z0-9-._~:/?#[\]@!$&'()*+,;=]*)?$/gi))(`${i}`))return void console.warn("logoUrl is not a valid url");t[n]=pt[n].format(i)}var o}),t})(l);if(!d)return;const{id:v,...c}=d||{},u=Object.keys(c),p=[];u.forEach(e=>{p.push(`${e}=${c[e]}`)}),p.push(`from=${window.location.origin}`),p.push(`sessionId=${r.sessionId}`),p.push(`appVersion=${t.version}`);const m=`${i(s||(null===(o=bt.options)||void 0===o?void 0:o.env)||"prod")}/#/standalone/${"recurring"===e.mode?"recurring":"checkout"}?${p.join("&")}`;if(a)return m;window.location.href=m};let At=null,St=!1;const Lt=["applePayButton","dropIn"],xt=(e,t)=>{var n,i,o,s,a,l;Y({orderSessionId:r.sessionId,env:(null===(n=bt.options)||void 0===n?void 0:n.env)||"prod",merchantId:null===(i=bt.options)||void 0===i?void 0:i.merchantId}),Et||(Et=(()=>{if(At)return()=>{At&&(window.removeEventListener("securitypolicyviolation",At),At=null)};At=e=>{var t,n;((null===(t=e.blockedURI)||void 0===t?void 0:t.includes("applepay.cdn-apple.com"))||(null===(n=e.blockedURI)||void 0===n?void 0:n.includes("apple-pay-sdk.js")))&&"enforce"===e.disposition&&(St=!0)},window.addEventListener("securitypolicyviolation",At);const e=()=>{At&&(window.removeEventListener("securitypolicyviolation",At),At=null),window.removeEventListener("beforeunload",e),window.removeEventListener("popstate",e)};return window.addEventListener("beforeunload",e),window.addEventListener("popstate",e),e})()),Lt.includes(e)&&(()=>{if(document.querySelector('script[src*="apple-pay-sdk.js"]'))return;const e=document.createElement("script");e.src="https://applepay.cdn-apple.com/jsapi/v1.3.2/apple-pay-sdk.js",e.crossOrigin="anonymous",e.integrity="sha384-DZRWMZLyVXr+7shJfal8pIG2v4KisLoSWFjZQMUv0+GWaCwoa82qeHsWrbBIUDPU",e.onerror=e=>{var t;console.warn("Failed to load Apple Pay SDK:",e),B({env:null===(t=bt.options)||void 0===t?void 0:t.env,eventName:$,error:e})},e.onload=()=>{console.debug("Apple Pay SDK loaded successfully")},document.head.appendChild(e)})();const d=z(e,t);if(B({env:null===(o=bt.options)||void 0===o?void 0:o.env,eventName:"createElement",options:t},{elementType:e,intentId:H(t),isExpressCheckout:d,mode:(null==t?void 0:t.mode)||"payment"}),!Ct.popup){const e=new mt(bt.gatewayUrl,{sessionId:r.sessionId},{origin:window.location.origin});kt("popup",e),(null==e?void 0:e.iframe)&&(null===(s=null===document||void 0===document?void 0:document.body)||void 0===s||s.appendChild(null==e?void 0:e.iframe)),(({gatewayUrl:e})=>{window.addEventListener("message",t=>{var n,i,o,s,a,l,d,r;const v="data"in t?t.data:t.detail,c="data"in t&&t.origin===e&&t.isTrusted,u=null===(n=Ut("popup"))||void 0===n?void 0:n.iframe;if(c)switch(null==v?void 0:v.code){case"onInitializePopup":u&&(null===(i=null==u?void 0:u.contentWindow)||void 0===i||i.postMessage({code:"update",options:{convertedVariables:null==v?void 0:v.convertedVariables}},e));break;case"onShowPopup":u&&(null===(o=null==u?void 0:u.contentWindow)||void 0===o||o.postMessage({code:"update",options:{...v.popup,sourceElement:null==v?void 0:v.type}},e),u.style.display="block");break;case"onTriggerPopupAction":"CLOSE"===(null===(s=null==v?void 0:v.popup)||void 0===s?void 0:s.triggeredButtonName)?u&&(u.style.display="none"):null===(r=null===(d=null===(l=Ut(null===(a=null==v?void 0:v.popup)||void 0===a?void 0:a.sourceElement))||void 0===l?void 0:l.iframe)||void 0===d?void 0:d.contentWindow)||void 0===r||r.postMessage(v,e)}})})({gatewayUrl:bt.gatewayUrl})}const v=null!=t?t:{origin:"",appearance:{},layout:{}};if(v.origin=v.origin||(null===(a=bt.options)||void 0===a?void 0:a.origin)||(null===(l=null===window||void 0===window?void 0:window.location)||void 0===l?void 0:l.origin),v.appearance=v.appearance||{},v.layout=v.layout||{},!gt.includes(e))return console.warn(`createElement with type: ${e} not support!`),null;switch(e){case"cardNumber":return Ct[e]=new je(bt.gatewayUrl,r.sessionId,v),Ct[e];case"krCardNumber":return Ct[e]=new Ke(bt.gatewayUrl,r.sessionId,v),Ct[e];case"card":return Ct[e]=new Me(bt.gatewayUrl,r.sessionId,v),Ct[e];case"fullFeaturedCard":return Ct[e]=new tt(bt.gatewayUrl,r.sessionId,v),Ct[e];case"wechat":return Ct[e]=new it(bt.gatewayUrl,r.sessionId,v),Ct[e];case"qrcode":return Ct[e]=new st(bt.gatewayUrl,r.sessionId,v),Ct[e];case"redirect":return Ct[e]=new lt(bt.gatewayUrl,r.sessionId,v),Ct[e];case"applePayButton":return Ct[e]=new K(bt.gatewayUrl,r.sessionId,v),Ct[e];case"googlePayButton":return Ct[e]=new yt(bt.gatewayUrl,r.sessionId,v),Ct[e];case"dropIn":return Ct[e]=new Xe(bt.gatewayUrl,r.sessionId,v),Ct[e];case"expiry":Ct[e]=new Te(bt.gatewayUrl,r.sessionId,v);break;case"cvc":Ct[e]=new De(bt.gatewayUrl,r.sessionId,v);break;case"krCardExpiry":Ct[e]=new Oe(bt.gatewayUrl,r.sessionId,v);break;case"krCardPswFirst2":Ct[e]=new ze(bt.gatewayUrl,r.sessionId,v);break;case"krCardIdentifier":Ct[e]=new Je(bt.gatewayUrl,r.sessionId,v);break;default:return null}return window.addEventListener("message",t=>{var n,i,o,s,a,l,d;t.origin!==bt.gatewayUrl||!t.isTrusted||e!==(null===(n=t.data)||void 0===n?void 0:n.type)||"onChange"!==(null===(i=t.data)||void 0===i?void 0:i.code)&&"onBlur"!==(null===(o=t.data)||void 0===o?void 0:o.code)||null===(l=null===(a=null===(s=Ct.cardNumber)||void 0===s?void 0:s.iframe)||void 0===a?void 0:a.contentWindow)||void 0===l||l.postMessage({code:`update_${null===(d=t.data)||void 0===d?void 0:d.type}`,data:t.data},bt.gatewayUrl)}),Ct[e]},Nt=e=>{var t,n,i;return B({env:null===(t=bt.options)||void 0===t?void 0:t.env,eventName:"destroyElement",type:e},{elementType:e,intentId:H(null===(n=Ct[e])||void 0===n?void 0:n.options)}),ft.includes(e)?(null===(i=Ct[e])||void 0===i||i.destroy(),Ct[e]=null,!0):(console.warn(`destroyElement with type: ${e} not support!`),!1)},Ut=e=>ft.includes(e)?Ct[e]:(console.warn(`getElement with type: ${e} not support!`),null),kt=(e,t)=>{var n;return B({env:null===(n=bt.options)||void 0===n?void 0:n.env,eventName:"setElement"},{elementType:e,intentId:H(null==t?void 0:t.options)}),ft.includes(e)?(Ct[e]=t,!0):(console.warn(`destroyElement with type: ${e} not support!`),!1)},$t={init:It,createElement:xt,getElement:Ut,destroyElement:Nt,redirectToCheckout:Pt};return void 0===window._AirwallexSDKs&&(window._AirwallexSDKs={}),window._AirwallexSDKs.payment=$t,e.confirmPaymentIntent=async e=>{var t;B({env:null===(t=bt.options)||void 0===t?void 0:t.env,eventName:m,data:e},{elementType:"unknown",intentId:null==e?void 0:e.intent_id});const{element:n,...i}=e||{};return n?n.confirm(i):(console.warn("Card number element must be provided for card payment confirm!"),!1)},e.confirmPaymentIntentWithSavedCard=async e=>{var t;B({env:null===(t=bt.options)||void 0===t?void 0:t.env,eventName:m,variable:"confirmPaymentIntentWithSavedCard",data:e},{elementType:"unknown",intentId:null==e?void 0:e.intent_id});const{element:n,...i}=e||{};return n&&(null==e?void 0:e.methodId)?(null==e?void 0:e.element).confirm(i):(console.warn("Payment method id must be provided for cvc payment confirm!"),!1)},e.createElement=xt,e.createPaymentConsent=async e=>{var t;B({env:null===(t=bt.options)||void 0===t?void 0:t.env,eventName:g,data:e},{elementType:"unknown",intentId:null==e?void 0:e.intent_id});const{element:n,...i}=e||{};return n?(null==e?void 0:e.element).createPaymentConsent(i):(console.warn("Either payment method id or element must be provided for create payment consent!"),!1)},e.createPaymentMethod=async(e,t)=>{var n,i;B({env:null===(n=bt.options)||void 0===n?void 0:n.env,eventName:b,data:t},{elementType:"unknown",intentId:H(null===(i=null==t?void 0:t.element)||void 0===i?void 0:i.options)});const{element:o,...s}=t||{};return o?(null==t?void 0:t.element).createPaymentMethod({...s,client_secret:e}):(console.warn("Either payment method id or element must be provided for payment method create!"),!1)},e.destroyElement=Nt,e.getDeviceFingerprint=({intent_id:e="",env:t,overrideScript:n=!0})=>(B({severity:"verbose",eventName:M,methodName:"getDeviceFingerprint",intent_id:e,env:t}),G=e,T({sessionId:G}),t&&Y({orderSessionId:G,env:t,overrideScript:n}),G),e.getElement=Ut,e.getPaymentIntent=async(e,t)=>{var n,i;return B({env:null===(n=bt.options)||void 0===n?void 0:n.env,eventName:C},{elementType:"unknown",intentId:e}),(null===(i=Ct.cardNumber)||void 0===i?void 0:i.getPaymentIntent(e,t))||!1},e.handle3dsFlow=be,e.init=It,e.redirectToCheckout=Pt,e}({});